%% calcule de dx,dy...drz (directe)
theta1=0;theta2=0;theta3=0;theta4=0;theta5=0;
dtheta1=pi/6;dtheta2=pi/6;dtheta3=pi/6;dtheta4=pi/6;dtheta5=pi/6;

omega0_5 =[(sin(theta5)*(sin(theta1)*sin(theta4) + cos(theta4)*(cos(theta1)*cos(theta2)*sin(theta3) + cos(theta1)*cos(theta3)*sin(theta2))) + cos(theta5)*(cos(theta1)*sin(theta2)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)))*(dtheta4 + dtheta1*cos(theta3 - theta4)) + (cos(theta4)*sin(theta1) - sin(theta4)*(cos(theta1)*cos(theta2)*sin(theta3) + cos(theta1)*cos(theta3)*sin(theta2)))*(cos(theta5)*(dtheta1 + dtheta3) - dtheta5 + dtheta1*sin(theta3 + theta4)*sin(theta5)) + (sin(theta5)*(dtheta1 + dtheta3) - dtheta1*sin(theta3 + theta4)*cos(theta5))*(cos(theta5)*(sin(theta1)*sin(theta4) + cos(theta4)*(cos(theta1)*cos(theta2)*sin(theta3) + cos(theta1)*cos(theta3)*sin(theta2))) - sin(theta5)*(cos(theta1)*sin(theta2)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)));
 - (sin(theta5)*(cos(theta1)*sin(theta4) - cos(theta4)*(cos(theta2)*sin(theta1)*sin(theta3) + cos(theta3)*sin(theta1)*sin(theta2))) - cos(theta5)*(sin(theta1)*sin(theta2)*sin(theta3) - cos(theta2)*cos(theta3)*sin(theta1)))*(dtheta4 + dtheta1*cos(theta3 - theta4)) - (cos(theta1)*cos(theta4) + sin(theta4)*(cos(theta2)*sin(theta1)*sin(theta3) + cos(theta3)*sin(theta1)*sin(theta2)))*(cos(theta5)*(dtheta1 + dtheta3) - dtheta5 + dtheta1*sin(theta3 + theta4)*sin(theta5)) - (sin(theta5)*(dtheta1 + dtheta3) - dtheta1*sin(theta3 + theta4)*cos(theta5))*(cos(theta5)*(cos(theta1)*sin(theta4) - cos(theta4)*(cos(theta2)*sin(theta1)*sin(theta3) + cos(theta3)*sin(theta1)*sin(theta2))) + sin(theta5)*(sin(theta1)*sin(theta2)*sin(theta3) - cos(theta2)*cos(theta3)*sin(theta1)));
                                                                                                                                                                                                               (dtheta4 + dtheta1*cos(theta3 - theta4))*(cos(theta5)*(cos(theta2)*sin(theta3) + cos(theta3)*sin(theta2)) + cos(theta4)*sin(theta5)*(cos(theta2)*cos(theta3) - sin(theta2)*sin(theta3))) - (sin(theta5)*(dtheta1 + dtheta3) - dtheta1*sin(theta3 + theta4)*cos(theta5))*(sin(theta5)*(cos(theta2)*sin(theta3) + cos(theta3)*sin(theta2)) - cos(theta4)*cos(theta5)*(cos(theta2)*cos(theta3) - sin(theta2)*sin(theta3))) - sin(theta4)*(cos(theta2)*cos(theta3) - sin(theta2)*sin(theta3))*(cos(theta5)*(dtheta1 + dtheta3) - dtheta5 + dtheta1*sin(theta3 + theta4)*sin(theta5))];
 
v0_5 =[(cos(theta5)*(sin(theta1)*sin(theta4) + cos(theta4)*(cos(theta1)*cos(theta2)*sin(theta3) + cos(theta1)*cos(theta3)*sin(theta2))) - sin(theta5)*(cos(theta1)*sin(theta2)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)))*(sin(theta5)*(5*dtheta1 - dtheta4 + 5*dtheta1*cos(theta3) + 150*dtheta1*sin(theta3) - 5*dtheta1*cos(theta3 - theta4)) - cos(theta5)*(cos(theta4)*(150*dtheta2 + 150*dtheta3) - sin(theta4)*(5*dtheta2 + 5*dtheta3) + (27*dtheta1*cos(theta3)*cos(theta4))/2 + 150*dtheta2*cos(theta4)*sin(dtheta3) + 150*dtheta2*cos(theta3)*sin(theta4) - (27*dtheta1*sin(theta3)*sin(theta4))/2)) - (sin(theta5)*(sin(theta1)*sin(theta4) + cos(theta4)*(cos(theta1)*cos(theta2)*sin(theta3) + cos(theta1)*cos(theta3)*sin(theta2))) + cos(theta5)*(cos(theta1)*sin(theta2)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)))*(cos(theta5)*(5*dtheta2 + 5*dtheta3) - 5*dtheta3 - 5*dtheta1 + sin(theta4)*(150*dtheta2 + 150*dtheta3) - 150*dtheta2*cos(theta3)*cos(theta4) + (27*dtheta1*cos(theta3)*sin(theta4))/2 + (27*dtheta1*cos(theta4)*sin(theta3))/2 + 150*dtheta2*sin(theta3)*sin(theta4)) + (cos(theta4)*sin(theta1) - sin(theta4)*(cos(theta1)*cos(theta2)*sin(theta3) + cos(theta1)*cos(theta3)*sin(theta2)))*(cos(theta5)*(5*dtheta1 - dtheta4 + 5*dtheta1*cos(theta3) + 150*dtheta1*sin(theta3) - 5*dtheta1*cos(theta3 - theta4)) + sin(theta5)*(cos(theta4)*(150*dtheta2 + 150*dtheta3) - sin(theta4)*(5*dtheta2 + 5*dtheta3) + (27*dtheta1*cos(theta3)*cos(theta4))/2 + 150*dtheta2*cos(theta4)*sin(dtheta3) + 150*dtheta2*cos(theta3)*sin(theta4) - (27*dtheta1*sin(theta3)*sin(theta4))/2));
 (sin(theta5)*(cos(theta1)*sin(theta4) - cos(theta4)*(cos(theta2)*sin(theta1)*sin(theta3) + cos(theta3)*sin(theta1)*sin(theta2))) - cos(theta5)*(sin(theta1)*sin(theta2)*sin(theta3) - cos(theta2)*cos(theta3)*sin(theta1)))*(cos(theta5)*(5*dtheta2 + 5*dtheta3) - 5*dtheta3 - 5*dtheta1 + sin(theta4)*(150*dtheta2 + 150*dtheta3) - 150*dtheta2*cos(theta3)*cos(theta4) + (27*dtheta1*cos(theta3)*sin(theta4))/2 + (27*dtheta1*cos(theta4)*sin(theta3))/2 + 150*dtheta2*sin(theta3)*sin(theta4)) - (cos(theta1)*cos(theta4) + sin(theta4)*(cos(theta2)*sin(theta1)*sin(theta3) + cos(theta3)*sin(theta1)*sin(theta2)))*(cos(theta5)*(5*dtheta1 - dtheta4 + 5*dtheta1*cos(theta3) + 150*dtheta1*sin(theta3) - 5*dtheta1*cos(theta3 - theta4)) + sin(theta5)*(cos(theta4)*(150*dtheta2 + 150*dtheta3) - sin(theta4)*(5*dtheta2 + 5*dtheta3) + (27*dtheta1*cos(theta3)*cos(theta4))/2 + 150*dtheta2*cos(theta4)*sin(dtheta3) + 150*dtheta2*cos(theta3)*sin(theta4) - (27*dtheta1*sin(theta3)*sin(theta4))/2)) - (cos(theta5)*(cos(theta1)*sin(theta4) - cos(theta4)*(cos(theta2)*sin(theta1)*sin(theta3) + cos(theta3)*sin(theta1)*sin(theta2))) + sin(theta5)*(sin(theta1)*sin(theta2)*sin(theta3) - cos(theta2)*cos(theta3)*sin(theta1)))*(sin(theta5)*(5*dtheta1 - dtheta4 + 5*dtheta1*cos(theta3) + 150*dtheta1*sin(theta3) - 5*dtheta1*cos(theta3 - theta4)) - cos(theta5)*(cos(theta4)*(150*dtheta2 + 150*dtheta3) - sin(theta4)*(5*dtheta2 + 5*dtheta3) + (27*dtheta1*cos(theta3)*cos(theta4))/2 + 150*dtheta2*cos(theta4)*sin(dtheta3) + 150*dtheta2*cos(theta3)*sin(theta4) - (27*dtheta1*sin(theta3)*sin(theta4))/2));
                                                                                                                                                                                                           - (cos(theta5)*(cos(theta2)*sin(theta3) + cos(theta3)*sin(theta2)) + cos(theta4)*sin(theta5)*(cos(theta2)*cos(theta3) - sin(theta2)*sin(theta3)))*(cos(theta5)*(5*dtheta2 + 5*dtheta3) - 5*dtheta3 - 5*dtheta1 + sin(theta4)*(150*dtheta2 + 150*dtheta3) - 150*dtheta2*cos(theta3)*cos(theta4) + (27*dtheta1*cos(theta3)*sin(theta4))/2 + (27*dtheta1*cos(theta4)*sin(theta3))/2 + 150*dtheta2*sin(theta3)*sin(theta4)) - (sin(theta5)*(5*dtheta1 - dtheta4 + 5*dtheta1*cos(theta3) + 150*dtheta1*sin(theta3) - 5*dtheta1*cos(theta3 - theta4)) - cos(theta5)*(cos(theta4)*(150*dtheta2 + 150*dtheta3) - sin(theta4)*(5*dtheta2 + 5*dtheta3) + (27*dtheta1*cos(theta3)*cos(theta4))/2 + 150*dtheta2*cos(theta4)*sin(dtheta3) + 150*dtheta2*cos(theta3)*sin(theta4) - (27*dtheta1*sin(theta3)*sin(theta4))/2))*(sin(theta5)*(cos(theta2)*sin(theta3) + cos(theta3)*sin(theta2)) - cos(theta4)*cos(theta5)*(cos(theta2)*cos(theta3) - sin(theta2)*sin(theta3))) - sin(theta4)*(cos(theta5)*(5*dtheta1 - dtheta4 + 5*dtheta1*cos(theta3) + 150*dtheta1*sin(theta3) - 5*dtheta1*cos(theta3 - theta4)) + sin(theta5)*(cos(theta4)*(150*dtheta2 + 150*dtheta3) - sin(theta4)*(5*dtheta2 + 5*dtheta3) + (27*dtheta1*cos(theta3)*cos(theta4))/2 + 150*dtheta2*cos(theta4)*sin(dtheta3) + 150*dtheta2*cos(theta3)*sin(theta4) - (27*dtheta1*sin(theta3)*sin(theta4))/2))*(cos(theta2)*cos(theta3) - sin(theta2)*sin(theta3))];
dp=[v0_5;omega0_5]